# CH16
## 새롭게 알게 된 것
### Stateful
- 컨테이너는 기본적으로 임시(ephemeral) 특성
- 스테이트풀 애플리케이션은 영구 스토리지 필요
- 60%가 쿠버네티스에서 스테이트풀 앱 실행

### 주요 리소스
1. PersistentVolume (PV)
- 파드 라이프사이클과 독립적인 영구 스토리지
- 회수 정책: Retain(유지) / Delete(삭제)

2. PersistentVolumeClaim (PVC)
- 스토리지 요청 명세
- 크기, 액세스 모드, 스토리지 클래스 지정

3. StorageClass
- 동적 볼륨 프로비저닝 제공
- 볼륨 플러그인(provisioner) 지정
- 다양한 스토리지 특성(암호화, 속도) 구현 가능

4. CSI (Container Storage Interface)
- 쿠버네티스와 스토리지 시스템 간 표준 인터페이스
- 써드파티 벤더가 플러그인 개발 가능
- 액세스 모드
  - RWO: 단일 노드 읽기-쓰기
  - ROX: 다중 노드 읽기 전용
  - RWX: 다중 노드 읽기-쓰기

### 스테이트풀셋 (StatefulSet)주요 특징

- 순차적 네이밍: 이름-0, 이름-1, 이름-2
- 순차적 배포: 이전 파드가 Ready 상태여야 다음 파드 생성
- 역순 종료: 스케일 다운 시 역순으로 종료
- 헤드리스 서비스: 각 파드에 안정적인 네트워크 ID 제공
- 볼륨 템플릿: 각 파드가 개별 PVC 할당
- 볼륨 보존: 스테이트풀셋 삭제 후에도 PVC 유지

### 관리 주의사항
- 클러스터가 건강할 때만 스케일링
- 삭제 전 0으로 스케일 다운 권장
- 오퍼레이터 (Operator)

- 커스텀 리소스로 복잡한 애플리케이션 자동 관리
- 운영자의 도메인 지식을 코드로 자동화
- 주요 작업: 업그레이드, 백업/복원, 장애 시뮬레이션, 리더 선택 등


# CH16
## 새롭게 알게 된 것
### 요청 처리 흐름
- 인증 → 인가 → 어드미션 컨트롤 → 스토리지 저장

### 어드미션 컨트롤러
- API 서버 요청을 스토리지 저장 전 검증/변형
- 목적: 정책 적용, 보안 강화, 리소스 관리
- 타입
  - 스탠다드: API 서버에 컴파일됨 (NamespaceLifecycle, ResourceQuota 등)
  - 다이내믹: 런타임 구성 가능

### 인가(Authorization)
- "누가 무엇을 할 수 있는가" 결정
- 최소 권한 원칙 적용

- 주요 방식
  - Node: kubelet 권한 제한
  - ABAC: 속성 기반, 정책 파일 사용 (변경 시 재시작 필요)
  - RBAC: 역할 기반, 동적 관리 가능 권장

- Role/RoleBinding (네임스페이스 레벨)
- ClusterRole/ClusterRoleBinding (클러스터 레벨)
- Webhook: 외부 REST 서비스 호출 (지연 발생 가능)
